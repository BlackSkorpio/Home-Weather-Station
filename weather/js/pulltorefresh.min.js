/*! PullToRefresh pulltorefresh.js
 *  @License: MIT
 *  @author BoxFactura (@BoxFactura)
 *  @version 0.1.16
 *  @description A small, but powerful Javascript library crafted to power your webapp's pull to refresh feature. No markup needed, highly customizable and dependency-free!
 *  @url https://github.com/BoxFactura/pulltorefresh.js
**/
(function(b,a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a():typeof define==="function"&&define.amd?define(a):(b.PullToRefresh=a())}(this,(function(){var p={pullStartY:null,pullMoveY:null,handlers:[],styleEl:null,events:null,dist:0,state:"pending",timeout:null,distResisted:0,supportsPassive:false};try{window.addEventListener("test",null,{get passivefunction(){p.supportsPassive=true}})}catch(l){}function c(e){if(!e.ptrElement){var s=document.createElement("div");if(e.mainElement!==document.body){e.mainElement.parentNode.insertBefore(s,e.mainElement)}else{document.body.insertBefore(s,document.body.firstChild)}s.classList.add(((e.classPrefix)+"ptr"));s.innerHTML=e.getMarkup().replace(/__PREFIX__/g,e.classPrefix);e.ptrElement=s;if(typeof e.onInit==="function"){e.onInit(e)}if(!p.styleEl){p.styleEl=document.createElement("style");p.styleEl.setAttribute("id","pull-to-refresh-js-style");document.head.appendChild(p.styleEl)}p.styleEl.textContent=e.getStyles().replace(/__PREFIX__/g,e.classPrefix).replace(/\s+/g," ")}return e}function f(e){e.ptrElement.classList.remove(((e.classPrefix)+"refresh"));e.ptrElement.style[e.cssProp]="0px";setTimeout(function(){if(e.ptrElement&&e.ptrElement.parentNode){e.ptrElement.parentNode.removeChild(e.ptrElement);e.ptrElement=null}p.state="pending"},e.refreshTimeout)}function g(t){var e=t.ptrElement.querySelector(("."+(t.classPrefix)+"icon"));var s=t.ptrElement.querySelector(("."+(t.classPrefix)+"text"));if(e){if(p.state==="refreshing"){e.innerHTML=t.iconRefreshing}else{e.innerHTML=t.iconArrow}}if(s){if(p.state==="releasing"){s.innerHTML=t.instructionsReleaseToRefresh}if(p.state==="pulling"||p.state==="pending"){s.innerHTML=t.instructionsPullToRefresh}if(p.state==="refreshing"){s.innerHTML=t.instructionsRefreshing}}}var d={setupDOM:c,onReset:f,update:g};var i=(function(){var x;function w(z){var y=p.handlers.filter(function(A){return A.contains(z.target)})[0];p.enable=!!y;if(y&&p.state==="pending"){x=d.setupDOM(y);if(y.shouldPullToRefresh()){p.pullStartY=z.touches[0].screenY}clearTimeout(p.timeout);d.update(y)}}function e(y){if(!(x&&x.ptrElement&&p.enable)){return}if(!p.pullStartY){if(x.shouldPullToRefresh()){p.pullStartY=y.touches[0].screenY}}else{p.pullMoveY=y.touches[0].screenY}if(p.state==="refreshing"){if(x.shouldPullToRefresh()&&p.pullStartY<p.pullMoveY){y.preventDefault()}return}if(p.state==="pending"){x.ptrElement.classList.add(((x.classPrefix)+"pull"));p.state="pulling";d.update(x)}if(p.pullStartY&&p.pullMoveY){p.dist=p.pullMoveY-p.pullStartY}p.distExtra=p.dist-x.distIgnore;if(p.distExtra>0){y.preventDefault();x.ptrElement.style[x.cssProp]=(p.distResisted)+"px";p.distResisted=x.resistanceFunction(p.distExtra/x.distThreshold)*Math.min(x.distMax,p.distExtra);if(p.state==="pulling"&&p.distResisted>x.distThreshold){x.ptrElement.classList.add(((x.classPrefix)+"release"));p.state="releasing";d.update(x)}if(p.state==="releasing"&&p.distResisted<x.distThreshold){x.ptrElement.classList.remove(((x.classPrefix)+"release"));p.state="pulling";d.update(x)}}}function v(){if(!(x&&x.ptrElement&&p.enable)){return}if(p.state==="releasing"&&p.distResisted>x.distThreshold){p.state="refreshing";x.ptrElement.style[x.cssProp]=(x.distReload)+"px";x.ptrElement.classList.add(((x.classPrefix)+"refresh"));p.timeout=setTimeout(function(){var y=x.onRefresh(function(){return d.onReset(x)});if(y&&typeof y.then==="function"){y.then(function(){return d.onReset(x)})}if(!y&&!x.onRefresh.length){d.onReset(x)}},x.refreshTimeout)}else{if(p.state==="refreshing"){return}x.ptrElement.style[x.cssProp]="0px";p.state="pending"}d.update(x);x.ptrElement.classList.remove(((x.classPrefix)+"release"));x.ptrElement.classList.remove(((x.classPrefix)+"pull"));p.pullStartY=p.pullMoveY=null;p.dist=p.distResisted=0}function t(){if(x){x.mainElement.classList.toggle(((x.classPrefix)+"top"),x.shouldPullToRefresh())}}var u=p.supportsPassive?{passive:p.passive||false}:undefined;window.addEventListener("touchend",v);window.addEventListener("touchstart",w);window.addEventListener("touchmove",e,u);window.addEventListener("scroll",t);return{onTouchEnd:v,onTouchStart:w,onTouchMove:e,onScroll:t,destroy:function s(){window.removeEventListener("touchstart",w);window.removeEventListener("touchend",v);window.removeEventListener("touchmove",e,u);window.removeEventListener("scroll",t)}}});var o='\n<div class="__PREFIX__box">\n  <div class="__PREFIX__content">\n    <div class="__PREFIX__icon"></div>\n    <div class="__PREFIX__text"></div>\n  </div>\n</div>\n';var n="\n.__PREFIX__ptr {\n  box-shadow: inset 0 -3px 5px rgba(0, 0, 0, 0.12);\n  pointer-events: none;\n  font-size: 0.85em;\n  font-weight: bold;\n  top: 0;\n  height: 0;\n  transition: height 0.3s, min-height 0.3s;\n  text-align: center;\n  width: 100%;\n  overflow: hidden;\n  display: flex;\n  align-items: flex-end;\n  align-content: stretch;\n}\n\n.__PREFIX__box {\n  padding: 10px;\n  flex-basis: 100%;\n}\n\n.__PREFIX__pull {\n  transition: none;\n}\n\n.__PREFIX__text {\n  margin-top: .33em;\n  color: rgba(0, 0, 0, 0.3);\n}\n\n.__PREFIX__icon {\n  color: rgba(0, 0, 0, 0.3);\n  transition: transform .3s;\n}\n\n/*\nWhen at the top of the page, disable vertical overscroll so passive touch\nlisteners can take over.\n*/\n.__PREFIX__top {\n  touch-action: pan-x pan-down pinch-zoom;\n}\n\n.__PREFIX__release {\n  .__PREFIX__icon {\n    transform: rotate(180deg);\n  }\n}\n";var h={distThreshold:60,distMax:80,distReload:50,distIgnore:0,mainElement:"body",triggerElement:"body",ptrElement:".ptr",classPrefix:"ptr--",cssProp:"min-height",iconArrow:"&#8675;",iconRefreshing:"&hellip;",instructionsPullToRefresh:"Pull down to refresh",instructionsReleaseToRefresh:"Release to refresh",instructionsRefreshing:"Refreshing",refreshTimeout:500,getMarkup:function(){return o},getStyles:function(){return n},onInit:function(){},onRefresh:function(){return location.reload()},resistanceFunction:function(e){return Math.min(1,e/2.5)},shouldPullToRefresh:function r(){return typeof this.mainElement==="string"?!document.querySelector(this.mainElement).scrollTop:this.mainElement&&!this.mainElement.scrollTop}};var b=["mainElement","ptrElement","triggerElement"];var a=(function(s){var e={};Object.keys(h).forEach(function(t){e[t]=s[t]||h[t]});e.refreshTimeout=typeof s.refreshTimeout==="number"?s.refreshTimeout:h.refreshTimeout;b.forEach(function(t){if(typeof e[t]==="string"){e[t]=document.querySelector(e[t])}});if(!p.events){p.events=i()}e.contains=function(t){return e.triggerElement.contains(t)};e.destroy=function(){clearTimeout(p.timeout);p.handlers.splice(e.offset,1)};return e});var k={setPassiveMode:function j(e){p.passive=e},destroyAll:function m(){if(p.events){p.events.destroy();p.events=null}p.handlers.forEach(function(e){e.destroy()})},init:function q(e){if(e===void 0){e={}}var s=a(e);s.offset=p.handlers.push(s)-1;return s},_:{setupHandler:a,setupEvents:i,setupDOM:d.setupDOM,onReset:d.onReset,update:d.update}};return k})));